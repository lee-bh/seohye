<html>
    <head>
        <meta charset="utf-8">
        <title>동아시아 타이포그래피 연대기</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <h1 onclick="window.scrollTo(0,0); console.log('okay');">동아시아 타이포그래피 연대기</h1>
        <main id="main"></main>
        <script src="data.js"></script>
        <script>

data.sort((a, b) => a.yr - b.yr);
const startYr = data[0].yr;
const endYr = data[data.length - 1].yr;
const timeLength = endYr - startYr;
const stX = 100;
const stY = 100;
const intervalH = 10;
const intervalV = 40;

const main = document.getElementById("main");
let a = document.createElement("div");
a.id = "yrLineContainer"; main.appendChild(a);
let b = document.createElement("div");
b.id = "contents"; main.appendChild(b);
let c = document.createElement("div");
c.id = "yrTextContainer"; main.appendChild(c);


const content = document.getElementById("contents");
const yrLineContainer = document.getElementById("yrLineContainer");
const yrTextContainer = document.getElementById("yrTextContainer");

const contentsHeight = data.length*intervalV + stY*2;
content.style.height = contentsHeight + "px";
content.style.width = (timeLength*intervalH + stX + 400) + "px";

const yrLineSt = startYr - startYr%10;
const yrLineEnd = endYr + (10 - endYr%10);
const yrLineInterval = intervalH*10;
const yrLineCount = (yrLineEnd - yrLineSt)/10 + 5;
const stPos = -(startYr%10 * intervalH) + stX;
for(let i = 0; i < yrLineCount; i++){
    const yrLine = document.createElement("div");
    yrLine.classList.add("yrLine");
    yrLine.style.left = (stPos + i*yrLineInterval) + "px";
    yrLine.style.height = contentsHeight + "px";
    yrLineContainer.appendChild(yrLine);
    const yrText = document.createElement("div");
    yrText.classList.add("yrText");
    yrText.innerHTML = (yrLineSt + i*10).toString();
    yrText.style.left = (stPos + i*yrLineInterval + 4) + "px";
    yrText.style.top = "4px";
    yrTextContainer.appendChild(yrText);
}

for(let i=0; i<data.length; i++){
    let entry = document.createElement("div");
    entry.classList.add("entry");
    entry.innerHTML = `<div class="desc">${data[i].desc}</div>`;
    entry.style.left = (stX + (data[i].yr - startYr)*intervalH) + "px";
    entry.style.top = stY + i*intervalV + "px";
    if(data[i].nation == "한국"){ entry.style.borderColor = "#000"};
    if(data[i].nation == "일본"){ entry.style.borderColor = "#00F"};
    if(data[i].nation == "중국"){ entry.style.borderColor = "#F00"};
    content.appendChild(entry);
};

function createEntryDetail(item){
    for(let i =0; i<data.length; i++){
        const item = data[i];    
        let entry = document.createElement("div");
        entry.classList.add("detail");
        entry.innerHTML = `
            <div class="nation">${item.nation}</div>
            <div class="yr">${item.yr}</div>
            <div class="desc">${item.desc}</div>`;
        if(item.ex1 != null){entry.innerHTML += `<div class="ex1">${item.ex1}</div>`}
        if(item.ex2 != null){entry.innerHTML += `<div class="ex2">${item.ex2}</div>`}
        if(item.ex3 != null){entry.innerHTML += `<div class="ex3">${item.ex3}</div>`}
        if(item.cite1 != null){entry.innerHTML += `<div class="cite1">${item.cite1}</div>`}  
        document.body.appendChild(entry);
    }
}

let isDragging = false;
let startX , startY;
let currentX = 0, currentY = 0;

document.addEventListener('mousedown', (e) => {
  isDragging = true;
  startX = e.clientX - currentX;
  startY = e.clientY - currentY;
  content.style.cursor = 'grabbing';
  document.addEventListener('mousemove', onMouseMove);
  document.addEventListener('mouseup', onMouseUp);
});
function onMouseMove(e) {
  if (!isDragging) return;
  currentX = e.clientX - startX;
  currentY = e.clientY - startY;
  document.getElementById("yrTextContainer").style.left = currentX + "px";
  document.getElementById("yrLineContainer").style.left = currentX + "px";
  content.style.top = currentY + "px";
  content.style.left = currentX + "px";
  //content.style.transform = `translate(${currentX}px, ${currentY}px)`;
}
function onMouseUp(e) {
  isDragging = false;
  content.style.cursor = 'default';
  document.removeEventListener('mousemove', onMouseMove);
  document.removeEventListener('mouseup', onMouseUp);
}


        </script>
    </body>
</html>